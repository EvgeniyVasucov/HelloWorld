using System;
using System.Data;
using System.Net.Http.Json;
class Program
{
    static HttpClient httpClient = new HttpClient();
    static async Task Main(string[] args)
    {
        // получаем ответ по ссылке
        Text? text = await httpClient.GetFromJsonAsync<Text>("https://keysystems.ru/files/misc/tasks/template.json");
        //создаем DataSet таблицы
        DataSet dataSet = new DataSet(text?.DataSetName);
        for (int l = 0; l < 5; l++)
        {
            DataTable dataTable = new DataTable(text?.Tables?[l].TableName);
            dataSet.Tables.Add(dataTable); // добавляем таблицу в dataset
            // создаем столбцы для таблицы dataTable
            DataColumn Columns = new DataColumn("Columns", typeof(string));
            DataColumn Row = new DataColumn("Row", typeof(string));
            DataColumn DeletedRows = new DataColumn("DeletedRows", typeof(string));
            //Row.DefaultValue = "null"; // значение по умолчанию
            dataTable.Columns.AddRange(new DataColumn[] { Columns, Row, DeletedRows });
            // создаем строки
            for (int i = 0; i < text?.Tables?[l].Columns?.Length; i++)
            {
                DataRow row = dataTable.NewRow();
                row.ItemArray = new object[] { text?.Tables?[l].Columns?[i], text?.Tables?[l].Rows?[0][i], text?.Tables?[0].DeletedRows[0] };
                dataTable.Rows.Add(row); //добавляем строки
            }
        }

        //вывод
        Console.WriteLine(text?.DataSetName);
        foreach (DataTable table in dataSet.Tables)
        {
            Console.WriteLine(table.TableName);
            Console.Write("COLUMN\t\tROW\t");
            Console.WriteLine();
            foreach (DataRow stroka in table.Rows)
            {
                foreach (var cell in stroka.ItemArray)
                {
                    Console.Write(" {0}\t\t", cell);
                }
                Console.WriteLine();
            }
            Console.WriteLine("==========================");
        }
        Console.Read();
    }
}
//создаем дополнительные классы для объектов JSON
public class Text
{
    public string? DataSetName { get; set; }
    public List<Table>? Tables { get; set; }
}
public class Table
{
    public string? TableName { get; set; }
    public object[]? Columns { get; set; }
    public object[][]? Rows { get; set; }
    public object[]? DeletedRows { get; set; }
}
